<mvc:View
    controllerName="aryasalesregister.controller.salesregister"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:table="sap.ui.table"
    xmlns:f="sap.f"
    xmlns:layout="sap.ui.layout"
    height="100%"
    class="enterpriseSalesView"
>
    <f:FlexibleColumnLayout
        id="fcLayout"
        layout="OneColumn"
    >
        <f:beginColumnPages>
            <Page
                id="mainPage"
                title="Enterprise Sales Register Analytics"
                enableScrolling="false"
                class="sapUiSizeCompact enterprisePage"
                showNavButton="false"
                titleAlignment="Center"
            >
                <customHeader>
                    <OverflowToolbar
                        id="headerToolbar"
                        class="sapUiMediumMarginBottom enterpriseHeader"
                    >
                        <Title
                            id="headerTitle"
                            text="Sales Register Analytics"
                            level="H1"
                            class="enterpriseTitle"
                        />
                        <ToolbarSpacer id="headerSpacer" />

                        <HBox
                            id="statusIndicators"
                            alignItems="Center"
                            class="sapUiSmallMarginEnd"
                        >
                            <ObjectStatus
                                id="dataStatusIndicator"
                                text="{= ${salesData>/count} ? ${salesData>/count} + ' Records' : 'No Data'}"
                                state="{= ${salesData>/count} > 0 ? 'Success' : 'None'}"
                                icon="{= ${salesData>/count} > 0 ? 'sap-icon://database' : 'sap-icon://warning'}"
                                class="sapUiTinyMarginEnd statusIndicator"
                            />
                            <ObjectStatus
                                id="valueStatusIndicator"
                                text="{path: 'salesData>/totalAmount', formatter: '.formatNumber'}"
                                state="Success"
                                icon="sap-icon://money-bills"
                                class="sapUiTinyMarginEnd statusIndicator"
                                visible="{= ${salesData>/totalAmount} > 0}"
                            />
                        </HBox>

                        <Button
                            id="refreshAllBtn"
                            icon="sap-icon://refresh"
                            tooltip="Refresh Data"
                            type="Transparent"
                            press="onLoadData"
                            class="sapUiTinyMarginEnd"
                        />
                        <Button
                            id="enterpriseExportBtn"
                            icon="sap-icon://excel-attachment"
                            text="Export"
                            tooltip="Export to Excel"
                            type="Accept"
                            press="onExportToExcel"
                            enabled="{= ${salesData>/count} > 0}"
                            class="sapUiTinyMarginEnd"
                        />
                        <MenuButton
                            icon="sap-icon://action-settings"
                            tooltip="View Options"
                            type="Transparent"
                            class="sapUiTinyMarginEnd"
                        >
                            <menu>
                                <Menu>
                                    <MenuItem
                                        text="Show All Columns"
                                        icon="sap-icon://show"
                                        press="onSelectAllColumns"
                                    />
                                    <MenuItem
                                        text="Reset to Default"
                                        icon="sap-icon://reset"
                                        press="onResetDefaultColumns"
                                    />
                                </Menu>
                            </menu>
                        </MenuButton>
                    </OverflowToolbar>
                </customHeader>

                <content>
                    <Panel
                        id="enterpriseFilterPanel"
                        headerText="Filters"
                        expandable="true"
                        expanded="true"
                        class="sapUiMediumMargin enterpriseFilterPanel"
                    >
                        <headerToolbar>
                            <Toolbar>
                                <Title
                                    text="Filters"
                                    level="H2"
                                />
                                <ToolbarSpacer />
                                <Text
                                    text="{= ${salesData>/originalRecordCount} ? ${salesData>/originalRecordCount} + ' raw records → ' + ${salesData>/count} + ' grouped records' : 'Set date range to load data'}"
                                    class="sapUiSmallText sapThemeHighlight-asColor"
                                />
                            </Toolbar>
                        </headerToolbar>
                        <content>
                            <layout:Grid
                                id="filterGrid"
                                defaultSpan="XL3 L4 M6 S12"
                                hSpacing="0.5"
                                vSpacing="0.5"
                                containerQuery="true"
                                class="sapUiSmallMargin"
                            >
                                <VBox class="enterpriseFilterItem">
                                    <Label
                                        text="Date Range"
                                        required="true"
                                        design="Bold"
                                    />
                                    <DateRangeSelection
                                        id="dateRangeFilter"
                                        from="{filterData>/fromDate}"
                                        to="{filterData>/toDate}"
                                        class="enterpriseInput"
                                        valueState="{= ${filterData>/fromDate} &amp;&amp; ${filterData>/toDate} ? 'None' : 'Error'}"
                                        valueStateText="Date range is mandatory"
                                        displayFormat="medium"
                                        placeholder="Select date range..."
                                    />
                                    <Text
                                        text="⚠️ Required: Select date range or use Quick Periods"
                                        class="sapUiSmallText"
                                        visible="{= !${filterData>/fromDate} || !${filterData>/toDate}}"
                                    />
                                </VBox>

                                <VBox class="enterpriseFilterItem">
                                    <Label text="Billing Document" />
                                    <Input
                                        value="{filterData>/billingDocument}"
                                        placeholder="Enter billing document..."
                                        class="enterpriseInput"
                                    />
                                </VBox>

                                <VBox class="enterpriseFilterItem">
                                    <Label text="Sales Order" />
                                    <Input
                                        value="{filterData>/salesOrder}"
                                        placeholder="Enter sales order..."
                                        class="enterpriseInput"
                                    />
                                </VBox>

                                <VBox class="enterpriseFilterItem">
                                    <Label text="Document Type" />
                                    <ComboBox
                                        selectedKey="{filterData>/billingDocumentType}"
                                        class="enterpriseInput"
                                    >
                                        <core:Item
                                            key=""
                                            text="All Types"
                                        />
                                        <core:Item
                                            key="F2"
                                            text="Invoice (F2)"
                                        />
                                        <core:Item
                                            key="G2"
                                            text="Credit Memo (G2)"
                                        />
                                        <core:Item
                                            key="L2"
                                            text="Debit Memo (L2)"
                                        />
                                    </ComboBox>
                                </VBox>

                                <VBox class="enterpriseFilterItem">
                                    <Label text="Quick Periods" />
                                    <HBox wrap="Wrap">
                                        <Button
                                            text="Current Month"
                                            type="Ghost"
                                            press="onQuickFilterCurrentMonth"
                                            class="sapUiTinyMarginEnd sapUiTinyMarginBottom"
                                        />
                                        <Button
                                            text="Current Quarter"
                                            type="Ghost"
                                            press="onQuickFilterCurrentQuarter"
                                            class="sapUiTinyMarginEnd sapUiTinyMarginBottom"
                                        />
                                        <Button
                                            text="Current Year"
                                            type="Ghost"
                                            press="onQuickFilterCurrentYear"
                                            class="sapUiTinyMarginEnd sapUiTinyMarginBottom"
                                        />
                                        <Button
                                            text="Last Month"
                                            type="Ghost"
                                            press="onQuickFilterLastMonth"
                                            class="sapUiTinyMarginEnd sapUiTinyMarginBottom"
                                        />
                                    </HBox>
                                </VBox>

                                <VBox class="enterpriseFilterItem">
                                    <Label text="Actions" />
                                    <HBox>
                                        <Button
                                            text="Load Data"
                                            type="Emphasized"
                                            press="onLoadData"
                                            icon="sap-icon://database"
                                            class="sapUiTinyMarginEnd"
                                        />
                                        <Button
                                            text="Clear"
                                            type="Transparent"
                                            press="onClearFilters"
                                            icon="sap-icon://clear-all"
                                        />
                                    </HBox>
                                </VBox>
                            </layout:Grid>
                        </content>
                    </Panel>

                    <Panel
                        id="enterpriseProgressPanel"
                        visible="{loadingState>/loading}"
                        class="sapUiMediumMargin enterpriseProgressPanel"
                    >
                        <content>
                            <VBox class="sapUiMediumMargin">
                                <ProgressIndicator
                                    percentValue="{loadingState>/progress}"
                                    displayValue="{loadingState>/currentOperation}"
                                    state="Information"
                                    width="100%"
                                    class="sapUiMediumMarginBottom"
                                />
                                <Text
                                    text="Progress: {loadingState>/currentStep} of {loadingState>/totalSteps} steps ({loadingState>/progress}%)"
                                    class="sapUiSmallText"
                                />
                            </VBox>
                        </content>
                    </Panel>

                    <VBox
                        class="sapUiMediumMargin"
                        height="100%"
                    >
                        <OverflowToolbar class="enterpriseTableHeader">
                            <Title />

                            <ToolbarSpacer />

                            <!-- ✅ LOAD NEXT BUTTON AT THE TOP -->
                            <Button
                                visible="{pagination>/hasMore}"
                                text="{= 'Load Next ' + ${pagination>/pageSize} + 
                ' Records (Total: ' + ${pagination>/totalRecords} + ')' }"
                                icon="sap-icon://add"
                                type="Ghost"
                                press="onLoadMoreData"
                                class="sapUiTinyMarginEnd"
                            />

                            <SearchField
                                width="300px"
                                placeholder="Search..."
                                search="onTableSearch"
                                class="sapUiTinyMarginEnd enterpriseSearch"
                            />
                        </OverflowToolbar>

                        <table:Table
                            id="salesTable"
                            rows="{salesData>/results}"
                            selectionMode="MultiToggle"
                            enableColumnReordering="true"
                            enableColumnFreeze="true"
                            enableSelectAll="false"
                            width="100%"
                            rowHeight="44"
                            columnHeaderHeight="44"
                            class="salesTableScrollable enterpriseTable"
                            visibleRowCountMode="Interactive"
                            visibleRowCount="15"
                            enableBusyIndicator="true"
                            busyIndicatorDelay="0"
                            threshold="50"
                        >
                            <table:columns>
                                <table:Column
                                    id="actionsCol"
                                    width="8rem"
                                    hAlign="Center"
                                    resizable="false"
                                >
                                    <Label text="Actions" />
                                    <table:template>
                                        <Button
                                            icon="sap-icon://detail-view"
                                            text="Details"
                                            type="Emphasized"
                                            press="onViewRowDetails"
                                            class="enterpriseDetailsBtn"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="aryaDTRCol"
                                    width="12rem"
                                    sortProperty="ZXT2"
                                    visible="true"
                                >
                                    <!-- Changed from false -->
                                    <Label text="Arya DTR Invoice No." />
                                    <table:template>
                                        <Text
                                            text="{salesData>PurchaseOrderByCustomer}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="sapInvoiceCol"
                                    width="10rem"
                                    sortProperty="BillingDocument"
                                >
                                    <Label text="SAP Invoice No." />
                                    <table:template>
                                        <Link
                                            text="{salesData>BillingDocument}"
                                            press="onBillingDocumentPress"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="contractIdCol"
                                    width="12rem"
                                    sortProperty="ZXT4"
                                >
                                    <Label text="Contract ID/Trade ID" />
                                    <table:template>
                                        <Text text="{salesData>ZXT4}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="customerInfoCol"
                                    width="16rem"
                                    sortProperty="CustomerDisplay"
                                >
                                    <Label text="Customer Name(sold to)" />
                                    <table:template>
                                        <VBox>
                                            <Text
                                                text="{salesData>CustomerDisplay}"
                                                class="sapUiTinyMarginBottom sapUiLargeText"
                                            />                                        
                                        </VBox>
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="customerStateCol"
                                    width="8rem"
                                    sortProperty="CustomerState"
                                >
                                    <Label text="Customer State" />
                                    <table:template>
                                        <ObjectStatus
                                            text="{salesData>CustomerState}"
                                            state="Information"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="shipToCol"
                                    width="16rem"
                                    sortProperty="ShipToParty"
                                    visible="false"
                                >
                                    <Label text="Customer Name(ship to)" />
                                    <table:template>
                                        <VBox>
                                            <Text
                                                text="{salesData>ShipToDisplay}"
                                                class="sapUiTinyMarginBottom"
                                            />
                                            <Text
                                                text="{salesData>ShipToParty}"
                                                class="sapUiSmallText"
                                            />
                                        </VBox>
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="customerGSTINCol"
                                    width="12rem"
                                    sortProperty="CustomerGSTIN"
                                    visible="false"
                                >
                                    <Label text="Customer GSTIN" />
                                    <table:template>
                                        <Text
                                            text="{salesData>CustomerGSTIN}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="paymentTermsCol"
                                    width="10rem"
                                    sortProperty="CustomerPaymentTerms"
                                    visible="false"
                                >
                                    <Label text="Terms of Payment" />
                                    <table:template>
                                        <Text
                                            text="{salesData>CustomerPaymentTerms}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="salesOrderCol"
                                    width="10rem"
                                    sortProperty="SalesDocument"
                                >
                                    <Label text="Sale order No." />
                                    <table:template>
                                        <Link
                                            text="{salesData>SalesDocument}"
                                            press="onSalesDocumentPress"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="dueDateCol"
                                    width="9rem"
                                    sortProperty="NetDueDate"
                                    visible="false"
                                >
                                    <Label text="Due Date" />
                                    <table:template>
                                        <Text
                                            text="{path: 'salesData>NetDueDate', formatter: '.formatDate'}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="plantCol"
                                    width="10rem"
                                    sortProperty="Plant"
                                    visible="false"
                                >
                                    <Label text="Plant" />
                                    <table:template>
                                        <Text text="{salesData>Plant}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="invoiceTypeCol"
                                    width="10rem"
                                    sortProperty="BillingDocumentType"
                                    visible="false"
                                >
                                    <Label text="Invoice Type" />
                                    <table:template>
                                        <Text
                                            text="{salesData>BillingDocumentType}"
                                        />
                                    </table:template>
                                </table:Column>
                                <table:Column
                                    id="salesDivisionCol"
                                    width="12rem"
                                    sortProperty="Division"
                                    visible="false"
                                >
                                    <Label
                                        text="Sales Divison/Distribution Channel"
                                    />
                                    <table:template>
                                        <Text
                                            text="{= ${salesData>Division} &amp;&amp; ${salesData>DistributionChannel}
                    ? ${salesData>Division} + ' / ' + ${salesData>DistributionChannel}
                    : (${salesData>Division} || ${salesData>DistributionChannel} || '') }"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="taxCodeCol"
                                    width="8rem"
                                    sortProperty="TaxCode"
                                    visible="false"
                                >
                                    <Label text="Tax Code" />
                                    <table:template>
                                        <Text text="{salesData>TaxCode}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="headOfficeCol"
                                    width="10rem"
                                    sortProperty="CustomerHeadOffice"
                                    visible="false"
                                >
                                    <Label text="Head Office Code" />
                                    <table:template>
                                        <Text
                                            text="{salesData>CustomerHeadOffice}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="custGroup1Col"
                                    visible="true"
                                >
                                    <!-- Changed from false -->
                                    <Label text="Customer Group 1" />
                                    <table:template>
                                        <Text
                                            text="{salesData>CustomerGroup1}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="custGroup2Col"
                                    visible="true"
                                >
                                    <!-- Changed from false -->
                                    <Label text="Customer Group 2" />
                                    <table:template>
                                        <Text
                                            text="{salesData>CustomerGroup2}"
                                        />
                                    </table:template>
                                </table:Column>
                                <table:Column
                                    id="custGroup3Col"
                                    visible="true"
                                >
                                    <!-- Changed from false -->
                                    <Label text="Customer Group 3" />
                                    <table:template>
                                        <Text
                                            text="{salesData>CustomerGroup3}"
                                        />
                                    </table:template>
                                </table:Column>
                                <table:Column
                                    id="custGroup4Col"
                                    visible="true"
                                >
                                    <!-- Changed from false -->
                                    <Label text="Customer Group 4" />
                                    <table:template>
                                        <Text
                                            text="{salesData>CustomerGroup4}"
                                        />
                                    </table:template>
                                </table:Column>
                                <table:Column
                                    id="custGroup5Col"
                                    visible="true"
                                >
                                    <!-- Changed from false -->
                                    <Label text="Customer Group 5" />
                                    <table:template>
                                        <Text
                                            text="{salesData>CustomerGroup5}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="customerTypeCol"
                                    width="8rem"
                                    sortProperty="CustomerType"
                                >
                                    <Label text="Customer Type" />
                                    <table:template>
                                        <Text text="{salesData>CustomerType}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="invoiceMonthCol"
                                    width="10rem"
                                    sortProperty="BillingDocumentDate"
                                >
                                    <Label
                                        text="Invoice Raised for the Month"
                                    />
                                    <table:template>
                                        <Text
                                            text="{path: 'salesData>BillingDocumentDate', formatter: '.formatInvoiceMonth'}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="materialCodeCol"
                                    width="10rem"
                                    sortProperty="Product"
                                >
                                    <Label text="Material Code" />
                                    <table:template>
                                        <Text text="{salesData>Product}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="materialDescCol"
                                    width="16rem"
                                    sortProperty="ProductName"
                                >
                                    <Label text="Material Description" />
                                    <table:template>
                                        <Text text="{salesData>ProductName}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="glCodeCol"
                                    width="10rem"
                                    sortProperty="GLAccount"
                                    visible="false"
                                >
                                    <Label text="GL Code" />
                                    <table:template>
                                        <Text text="{salesData>GLAccount}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="hsnCol"
                                    width="8rem"
                                    sortProperty="SAC_HSN"
                                    visible="false"
                                >
                                    <Label text="SAC/HSN Code" />
                                    <table:template>
                                        <Text text="{salesData>SAC_HSN}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="panCol"
                                    width="10rem"
                                    sortProperty="PAN"
                                    visible="false"
                                >
                                    <Label text="PAN No." />
                                    <table:template>
                                        <Text text="{salesData>PAN}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="tanCol"
                                    width="10rem"
                                    sortProperty="TAN"
                                    visible="false"
                                >
                                    <Label text="TAN No." />
                                    <table:template>
                                        <Text text="{salesData>TAN}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="financialsCol"
                                    width="12rem"
                                    sortProperty="TotalNetAmount"
                                    hAlign="End"
                                >
                                    <Label text="Taxable Amount" />
                                    <table:template>
                                        <ObjectNumber
                                            number="{path: 'salesData>TotalNetAmount', formatter: '.formatNumber'}"
                                            unit="{salesData>TransactionCurrency}"
                                            state="{= ${salesData>TotalNetAmount} > 0 ? 'Information' : 'Warning'}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="discountCol"
                                    width="8rem"
                                    hAlign="End"
                                    sortProperty="DRV1"
                                    visible="false"
                                >
                                    <Label text="Discount" />
                                    <table:template>
                                        <ObjectNumber
                                            number="{path: 'salesData>DRV1', formatter: '.formatNumber'}"
                                            unit="{salesData>TransactionCurrency}"
                                            state="{path: 'salesData>DRV1', formatter: '.formatAmountState'}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="addChargesCol"
                                    width="8rem"
                                    hAlign="End"
                                    sortProperty="ZDV2"
                                    visible="false"
                                >
                                    <Label text="Additional Charges" />
                                    <table:template>
                                        <ObjectNumber
                                            number="{path: 'salesData>ZDV2', formatter: '.formatNumber'}"
                                            unit="{salesData>TransactionCurrency}"
                                            state="{path: 'salesData>ZDV2', formatter: '.formatAmountState'}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="igstCol"
                                    width="8rem"
                                    hAlign="End"
                                    sortProperty="JOIG"
                                    visible="false"
                                >
                                    <Label text="IGST" />
                                    <table:template>
                                        <ObjectNumber
                                            number="{path: 'salesData>JOIG', formatter: '.formatNumber'}"
                                            unit="{salesData>TransactionCurrency}"
                                            state="{path: 'salesData>JOIG', formatter: '.formatAmountState'}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="cgstCol"
                                    width="8rem"
                                    hAlign="End"
                                    sortProperty="JOCG"
                                    visible="false"
                                >
                                    <Label text="CGST" />
                                    <table:template>
                                        <ObjectNumber
                                            number="{path: 'salesData>JOCG', formatter: '.formatNumber'}"
                                            unit="{salesData>TransactionCurrency}"
                                            state="{path: 'salesData>JOCG', formatter: '.formatAmountState'}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="sgstCol"
                                    width="8rem"
                                    hAlign="End"
                                    sortProperty="JOSG"
                                    visible="false"
                                >
                                    <Label text="SGST" />
                                    <table:template>
                                        <ObjectNumber
                                            number="{path: 'salesData>JOSG', formatter: '.formatNumber'}"
                                            unit="{salesData>TransactionCurrency}"
                                            state="{path: 'salesData>JOSG', formatter: '.formatAmountState'}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="invoiceAmountCol"
                                    width="12rem"
                                    sortProperty="InvoiceAmount"
                                    hAlign="End"
                                >
                                    <Label text="Invoice Amount" />
                                    <table:template>
                                        <ObjectNumber
                                            number="{path: 'salesData>InvoiceAmount', formatter: '.formatNumber'}"
                                            unit="{salesData>TransactionCurrency}"
                                            state="Success"
                                            emphasized="true"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="profitCenterCol"
                                    width="10rem"
                                    sortProperty="ProfitCenter"
                                    visible="false"
                                >
                                    <Label text="Profit Centre" />
                                    <table:template>
                                        <Text text="{salesData>ProfitCenter}" />
                                    </table:template>
                                </table:Column>

                                <!-- Warehouse Code - ZXT1 -->
                                <table:Column
                                    id="warehouseCodeCol"
                                    width="10rem"
                                    sortProperty="ZXT1"
                                >
                                    <Label text="Warehouse Code" />
                                    <table:template>
                                        <Text text="{salesData>ZXT1}" />
                                    </table:template>
                                </table:Column>

                                <!-- Warehouse Name - ZXT3 (separate column) -->
                                <table:Column
                                    id="warehouseNameCol"
                                    width="12rem"
                                    sortProperty="ZXT3"
                                >
                                    <Label text="Warehouse Name" />
                                    <table:template>
                                        <Text text="{salesData>ZXT3}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="servicePeriodCol"
                                    width="18rem"
                                    sortProperty="ZXT5"
                                >
                                    <Label text="Warehouse State" />
                                    <table:template>
                                        <Text text="{salesData>ZXT5}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="warehouseLocationCol"
                                    width="10rem"
                                    sortProperty="ZXT6"
                                    visible="false"
                                >
                                    <Label text="Warehouse Location" />
                                    <table:template>
                                        <Text text="{salesData>ZXT6}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="clusterIdCol"
                                    width="10rem"
                                    sortProperty="ZXT7"
                                    visible="false"
                                >
                                    <Label text="Cluster ID" />
                                    <table:template>
                                        <Text text="{salesData>ZXT7}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="parentInvoiceCol"
                                    width="12rem"
                                    sortProperty="ZXT8"
                                    visible="false"
                                >
                                    <Label text="Parent Invoice No." />
                                    <table:template>
                                        <Text text="{salesData>ZXT8}" />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="docStatusCol"
                                    width="12rem"
                                    sortProperty="BillingDocumentType"
                                >
                                    <Label text="E-invoice Status" />
                                    <table:template>
                                        <VBox>
                                            <ObjectStatus
                                                text="{salesData>EInvoiceStatus}"
                                                state="{path: 'salesData>EInvoiceStatus', formatter: '.formatEInvoiceState'}"
                                                visible="{= !!${salesData>EInvoiceStatus}}"
                                            />
                                        </VBox>
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="quantityCol"
                                    width="10rem"
                                    sortProperty="BillingQuantity"
                                    hAlign="End"
                                >
                                    <Label text="Qty." />
                                    <table:template>
                                        <ObjectNumber
                                            number="{path: 'salesData>BillingQuantity', formatter: '.formatNumber'}"
                                            unit="{salesData>BillingQuantityUnit}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="ratePerMTCol"
                                    width="10rem"
                                    hAlign="End"
                                    visible="false"
                                >
                                    <Label text="Rate/MT" />
                                    <table:template>
                                        <ObjectNumber
                                            number="{path: 'salesData>ZXT10', formatter: '.formatNumber'}"
                                            unit="INR"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="delayChargesCol"
                                    width="8rem"
                                    hAlign="End"
                                    sortProperty="ZDV4"
                                    visible="false"
                                >
                                    <Label text="Delay Charges" />
                                    <table:template>
                                        <ObjectNumber
                                            number="{path: 'salesData>ZDV4', formatter: '.formatNumber'}"
                                            unit="{salesData>TransactionCurrency}"
                                            state="{path: 'salesData>ZDV4', formatter: '.formatAmountState'}"
                                        />
                                    </table:template>
                                </table:Column>

                                <!-- E-Way Bill Number -->
                                <table:Column
                                    id="ewayBillCol"
                                    width="14rem"
                                    sortProperty="EWayBillNo"
                                >
                                    <Label text="E-way Bill No." />
                                    <table:template>
                                        <Text text="{salesData>EWayBillNo}" />
                                    </table:template>
                                </table:Column>

                                <!-- E-Way Bill Status -->
                                <table:Column
                                    id="ewayBillStatusCol"
                                    width="10rem"
                                    sortProperty="EInvoiceStatus"
                                    visible="false"
                                >
                                    <Label text="E-way Bill Status" />
                                    <table:template>
                                        <Text
                                            text="{salesData>EInvoiceStatus}"
                                        />
                                    </table:template>
                                </table:Column>

                                <!-- E-Way Bill Date -->
                                <table:Column
                                    id="ewayBillDateCol"
                                    width="12rem"
                                    sortProperty="EWayBillDate"
                                    visible="false"
                                >
                                    <Label text="E-way Bill Valid To" />
                                    <table:template>
                                        <Text
                                            text="{path: 'salesData>EWayBillDate', formatter: '.formatDate'}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="tcsCol"
                                    width="8rem"
                                    hAlign="End"
                                    sortProperty="ZTCS"
                                    visible="false"
                                >
                                    <Label text="TCS" />
                                    <table:template>
                                        <ObjectNumber
                                            number="{path: 'salesData>ZTCS', formatter: '.formatNumber'}"
                                            unit="{salesData>TransactionCurrency}"
                                            state="{path: 'salesData>ZTCS', formatter: '.formatAmountState'}"
                                        />
                                    </table:template>
                                </table:Column>
                            </table:columns>
                        </table:Table>
                    </VBox>

                    <IllustratedMessage
                        id="noDataIllustration"
                        visible="{= !${loadingState>/loading} &amp;&amp; ${salesData>/count} === 0}"
                        illustrationType="sapIllus-EmptyList"
                        title="Ready to Load Sales Data"
                        description="Select a date range and click 'Load Data'"
                        class="sapUiMediumMargin"
                    >
                        <additionalContent>
                            <Button
                                text="Load Current Month"
                                type="Emphasized"
                                press="onQuickFilterCurrentMonth"
                                icon="sap-icon://database"
                                class="sapUiMediumMarginTop"
                            />
                        </additionalContent>
                    </IllustratedMessage>
                </content>

                <footer>
                    <OverflowToolbar>
                        <ToolbarSpacer />
                        <Text
                            text="Sales Register Analytics v2.0"
                            class="sapUiSmallText"
                        />
                        <ToolbarSpacer />
                        <ObjectStatus
                            text="{= ${salesData>/lastLoadTime} ? 'Last load: ' + ${salesData>/lastLoadTime} : 'No data loaded'}"
                            state="Information"
                        />
                    </OverflowToolbar>
                </footer>
            </Page>
        </f:beginColumnPages>
    </f:FlexibleColumnLayout>
</mvc:View>
