<mvc:View
    controllerName="salesregister.controller.SalesRegister"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core"
    xmlns="sap.m"
    xmlns:f="sap.f"
    xmlns:table="sap.ui.table"
>
    <Page
        id="page"
        title="{i18n>title}"
    >
        <content>
            <VBox
                id="_IDGenVBox"
                class="sapUiMediumMargin"
            >
                <!-- Header with Filters and Export Button -->
                <Panel
                    id="_IDGenPanel"
                    headerText="Filters and Actions"
                    class="sapUiResponsiveMargin"
                >
                    <content>
                        <HBox
                            id="_IDGenHBox"
                            class="sapUiMediumMargin"
                        >
                            <VBox
                                id="_IDGenVBox1"
                                class="sapUiMediumMarginEnd"
                            >
                                <Label
                                    id="_IDGenLabel"
                                    text="Date From:"
                                />
                                <DatePicker
                                    id="dateFrom"
                                    value="{/dateFrom}"
                                />
                            </VBox>
                            <VBox
                                id="_IDGenVBox2"
                                class="sapUiMediumMarginEnd"
                            >
                                <Label
                                    id="_IDGenLabel1"
                                    text="Date To:"
                                />
                                <DatePicker
                                    id="dateTo"
                                    value="{/dateTo}"
                                />
                            </VBox>
                            <VBox
                                id="_IDGenVBox3"
                                class="sapUiMediumMarginEnd"
                            >
                                <Label
                                    id="_IDGenLabel2"
                                    text="Plant:"
                                />
                                <Input
                                    id="plantFilter"
                                    value="{/plantFilter}"
                                    placeholder="Enter Plant"
                                />
                            </VBox>
                            <VBox
                                id="_IDGenVBox4"
                                class="sapUiMediumMarginEnd"
                            >
                                <Label
                                    id="_IDGenLabel3"
                                    text="Material:"
                                />
                                <Input
                                    id="materialFilter"
                                    value="{/materialFilter}"
                                    placeholder="Enter Material"
                                />
                            </VBox>
                        </HBox>
                        <HBox
                            id="_IDGenHBox1"
                            class="sapUiMediumMargin"
                        >
                            <Button
                                id="_IDGenButton"
                                text="Load Data"
                                press="onLoadData"
                                type="Emphasized"
                                class="sapUiMediumMarginEnd"
                            />
                            <Button
                                id="_IDGenButton1"
                                text="Export to Excel"
                                press="onExportToExcel"
                                type="Accept"
                                class="sapUiMediumMarginEnd"
                            />
                            <Button
                                id="_IDGenButton2"
                                text="Clear Filters"
                                press="onClearFilters"
                            />
                        </HBox>
                    </content>
                </Panel>

                <!-- Data Table -->
                <Panel
                    id="_IDGenPanel1"
                    headerText="Sales Register Data"
                    class="sapUiResponsiveMargin"
                >
                    <content>
                        <table:Table
                            id="salesTable"
                            rows="{/salesData}"
                            selectionMode="MultiToggle"
                            enableSelectAll="true"
                            ariaLabelledBy="title"
                            visibleRowCount="20"
                            fixedColumnCount="3"
                        >
                            <table:extension>
                                <OverflowToolbar id="_IDGenOverflowToolbar">
                                    <Title
                                        id="_IDGenTitle"
                                        text="Sales Register ({/salesData/length} records)"
                                    />
                                    <ToolbarSpacer id="_IDGenToolbarSpacer" />
                                    <Button
                                        id="_IDGenButton3"
                                        text="Select All"
                                        press="onSelectAll"
                                    />
                                    <Button
                                        id="_IDGenButton4"
                                        text="Deselect All"
                                        press="onDeselectAll"
                                    />
                                </OverflowToolbar>
                            </table:extension>

                            <table:columns>
                                <table:Column
                                    id="_IDGenColumn1"
                                    width="120px"
                                    sortProperty="BillingDocument"
                                >
                                    <Label
                                        id="_IDGenLabel4"
                                        text="Billing Document"
                                    />
                                    <table:template>
                                        <Text
                                            id="_IDGenText"
                                            text="{BillingDocument}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="_IDGenColumn2"
                                    width="100px"
                                    sortProperty="BillingDocumentDate"
                                >
                                    <Label
                                        id="_IDGenLabel5"
                                        text="Billing Date"
                                    />
                                    <table:template>
                                        <Text
                                            id="_IDGenText1"
                                            text="{path: 'BillingDocumentDate', type: 'sap.ui.model.odata.type.DateTime', formatOptions: {pattern: 'dd.MM.yyyy'}}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="_IDGenColumn3"
                                    width="120px"
                                    sortProperty="SalesDocument"
                                >
                                    <Label
                                        id="_IDGenLabel6"
                                        text="Sales Document"
                                    />
                                    <table:template>
                                        <Text
                                            id="_IDGenText2"
                                            text="{SalesDocument}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="_IDGenColumn4"
                                    width="200px"
                                    sortProperty="SalesOrderText"
                                >
                                    <Label
                                        id="_IDGenLabel7"
                                        text="Sales Order Text"
                                    />
                                    <table:template>
                                        <Text
                                            id="_IDGenText3"
                                            text="{SalesOrderText}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="_IDGenColumn5"
                                    width="200px"
                                    sortProperty="BusinessPartnerName1"
                                >
                                    <Label
                                        id="_IDGenLabel8"
                                        text="Customer Name"
                                    />
                                    <table:template>
                                        <Text
                                            id="_IDGenText4"
                                            text="{BusinessPartnerName1}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="_IDGenColumn6"
                                    width="100px"
                                    sortProperty="Plant"
                                >
                                    <Label
                                        id="_IDGenLabel9"
                                        text="Plant"
                                    />
                                    <table:template>
                                        <Text
                                            id="_IDGenText5"
                                            text="{Plant}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="_IDGenColumn7"
                                    width="150px"
                                    sortProperty="Material"
                                >
                                    <Label
                                        id="_IDGenLabel10"
                                        text="Material"
                                    />
                                    <table:template>
                                        <Text
                                            id="_IDGenText6"
                                            text="{Material}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="_IDGenColumn8"
                                    width="120px"
                                    sortProperty="TotalNetAmount"
                                >
                                    <Label
                                        id="_IDGenLabel11"
                                        text="Net Amount"
                                    />
                                    <table:template>
                                        <Text
                                            id="_IDGenText7"
                                            text="{path: 'TotalNetAmount', type: 'sap.ui.model.odata.type.Decimal', formatOptions: {minFractionDigits: 2, maxFractionDigits: 2}} {TransactionCurrency}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="_IDGenColumn9"
                                    width="100px"
                                    sortProperty="BillingQuantity"
                                >
                                    <Label
                                        id="_IDGenLabel12"
                                        text="Quantity"
                                    />
                                    <table:template>
                                        <Text
                                            id="_IDGenText8"
                                            text="{path: 'BillingQuantity', type: 'sap.ui.model.odata.type.Decimal', formatOptions: {minFractionDigits: 3, maxFractionDigits: 3}} {BillingQuantityUnit}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="_IDGenColumn10"
                                    width="100px"
                                    sortProperty="Division"
                                >
                                    <Label
                                        id="_IDGenLabel13"
                                        text="Division"
                                    />
                                    <table:template>
                                        <Text
                                            id="_IDGenText9"
                                            text="{Division}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="_IDGenColumn11"
                                    width="100px"
                                    sortProperty="Region"
                                >
                                    <Label
                                        id="_IDGenLabel14"
                                        text="Region"
                                    />
                                    <table:template>
                                        <Text
                                            id="_IDGenText10"
                                            text="{Region}"
                                        />
                                    </table:template>
                                </table:Column>

                                <table:Column
                                    id="_IDGenColumn12"
                                    width="120px"
                                    sortProperty="ProfitCenter"
                                >
                                    <Label
                                        id="_IDGenLabel15"
                                        text="Profit Center"
                                    />
                                    <table:template>
                                        <Text
                                            id="_IDGenText11"
                                            text="{ProfitCenter}"
                                        />
                                    </table:template>
                                </table:Column>
                            </table:columns>
                        </table:Table>
                    </content>
                </Panel>

                <!-- Loading Indicator -->
                <BusyDialog
                    id="busyDialog"
                    text="Loading data..."
                />
            </VBox>
        </content>
    </Page>
</mvc:View>
